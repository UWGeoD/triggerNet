# triggerNet

A Python pipeline for clustering energy releases (e.g., earthquakes, microseismicity, or acoustic emissions) catalogs using nearest-neighbor distance (NND) analysis.  
Automatically detects event clusters, computes key statistics, and generates summary plots—supporting both research and exploratory data analysis.

**Author:** Ellie Johnson

---

## Table of Contents

- [Features](#features)
- [Installation](#installation)
- [Quick Start](#quick-start)
- [Usage](#usage)
- [Repository Structure](#repository-structure)
- [License](#license)
- [Citation](#citation)

---

## Features

- **Flexible Input:** Works with CSV or MATLAB (.mat) catalogs.
- **Robust Parameterization:** Auto-estimates or uses user-provided b-value, fractal dimension, and other clustering parameters.
- **Cluster Extraction:** Builds a spanning tree and extracts cluster forests via thresholding.
- **Diagnostic Plots:** Generates histograms and contour plots comparing original vs. randomized catalogs.
- **Modular Design:** Core logic is cleanly separated for easy extension.
- **CLI Ready:** All paths and parameters are configurable via command line.

---

## Installation

### 1. Clone the Repository

```bash
git clone https://github.com/UWGeoD/triggerNet.git
cd triggerNet
````

### 2. Install Dependencies

**Recommended:** Use a virtual environment.

```bash
python -m venv venv
source venv/bin/activate
```

**Install dependencies:**

```bash
pip install -r requirements.txt
```

---

## Quick Start

```bash
python src/main.py \
  -i data/catalog.csv \
  -o results \
  --mag_col magnitude \
  --x_col longitude \
  --y_col latitude
```

* Results and plots will appear in `/results` and `/plots` directories.

---

## Usage

**Command-Line Options:**

| Flag                    | Description                                             | Default    |
| ----------------------- | ------------------------------------------------------- | ---------- |
| `-i`, `--input`         | Path to input catalog (`.csv` or `.mat`)                | *required* |
| `-o`, `--output_prefix` | Prefix for output files                                 | `results`  |
| `--time_col`            | Name of time column in input                            | `time`     |
| `--x_col`               | Name of x (lon) column                                  | `x`        |
| `--y_col`               | Name of y (lat) column                                  | `y`        |
| `--z_col`               | Name of z (depth) column                                | None       |
| `--mag_col`             | Name of magnitude column                                | `mag`      |
| `--time_format`         | Datetime parsing format                                 | None       |
| `--mag_cutoff`          | Minimum magnitude to include                            | None       |
| `--b`                   | b-value (auto-estimated if not set)                     | None       |
| `--df`                  | Fractal dimension (auto-estimated if not set)           | None       |
| `--eta0`                | Threshold for strong links (auto-estimated if not set)  | None       |

*Example:*

```bash
python src/main.py -i data/catalog.csv -o demo --mag_cutoff 2.0
```

**Outputs:**

* `results/<prefix>_nnd.csv`: Catalog with NND and parent assignments.
* `results/<prefix>_tree.csv`: Spanning tree edges.
* `results/<prefix>_adjacency.csv`: Strong-link adjacency matrix.
* `results/<prefix>_clusters.txt`: List of clusters (components).
* `plots/<prefix>_hist.png`: Histogram of log₁₀(η) (original and w/ shuffled).
* `plots/<prefix>_overlaid.png`: Contour plot (original and w/ shuffled).

---

## Repository Structure

```
triggerNet/
├── src/
│   ├── main.py
│   ├── config.py
│   ├── data_io.py
│   ├── analysis.py
│   ├── clustering.py
│   └── utils.py
├── data/
├── plots/
├── results/
├── README.md
├── LICENSE
├── requirements.txt
├── .gitignore
```

* **src/**: Source code (main pipeline, analysis, clustering, utilities)
* **data/**: Input catalogs
* **plots/**: Output plots (autogenerated)
* **results/**: Output CSVs (autogenerated)

---

## License

This project is licensed under the [MIT License](LICENSE).

---

## Citation

If you use this pipeline in academic work, please cite as:

```
@software{johnson2025triggerNet,
  author    = {Ellie Johnson},
  title     = {triggerNet: Nearest-Neighbor Energy Release Clustering Pipeline},
  year      = {2025},
  url       = {https://github.com/UWGeoD/triggerNet},
  version   = {v1.0.0},
}
```

---

**Questions?**
Open an [issue](https://github.com/UWGeoD/triggerNet/issues) or email the maintainer!
